-- Adminer 4.8.1 MySQL 5.5.5-10.6.16-MariaDB-0ubuntu0.22.04.1 dump

SET NAMES utf8;
SET time_zone = '+00:00';
SET foreign_key_checks = 0;
SET sql_mode = 'NO_AUTO_VALUE_ON_ZERO';

SET NAMES utf8mb4;

DROP TABLE IF EXISTS `etat`;
CREATE TABLE `etat` (
  `ETA_ID` char(2) NOT NULL,
  `ETA_LIB` varchar(30) NOT NULL,
  PRIMARY KEY (`ETA_ID`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;


DROP TABLE IF EXISTS `etat_dono`;
CREATE TABLE `etat_dono` (
  `ETA_ID` char(2) NOT NULL,
  `ETA_LIB` varchar(30) NOT NULL,
  PRIMARY KEY (`ETA_ID`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

INSERT INTO `etat_dono` (`ETA_ID`, `ETA_LIB`) VALUES
('CL',	'Saisie clôturée'),
('CR',	'Fiche créée, saisie en cours'),
('RB',	'Remboursée'),
('VA',	'Validée et mise en paiement');

DROP TABLE IF EXISTS `etat_yann`;
CREATE TABLE `etat_yann` (
  `ETA_ID` char(2) NOT NULL,
  `ETA_LIB` varchar(30) NOT NULL,
  PRIMARY KEY (`ETA_ID`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

INSERT INTO `etat_yann` (`ETA_ID`, `ETA_LIB`) VALUES
('CL',	'Saisie clôturée'),
('CR',	'Fiche créée, saisie en cours'),
('RB',	'Remboursée'),
('VA',	'Validée et mise en paiement');

DROP TABLE IF EXISTS `fiche_frais`;
CREATE TABLE `fiche_frais` (
  `FFR_ID` int(11) NOT NULL,
  `VIS_ID` char(4) NOT NULL,
  `ETA_ID` char(2) NOT NULL,
  `FFR_ANNEE` char(4) NOT NULL,
  `FFR_MOIS` enum('JANVIER','FEVRIER','MARS','AVRIL','MAI','JUIN','JUILLET','AOUT','SEPTEMBRE','OCTOBRE','NOVEMBRE','DECEMBRE') NOT NULL,
  `FFR_MONTANT_VALIDE` decimal(10,2) NOT NULL,
  `FFR_NB_JUSTIFICATIF` int(11) NOT NULL,
  `FFR_DATE_MODIF` date NOT NULL,
  PRIMARY KEY (`FFR_ID`),
  KEY `VIS_ID` (`VIS_ID`),
  KEY `ETA_ID` (`ETA_ID`),
  CONSTRAINT `fiche_frais_ibfk_2` FOREIGN KEY (`ETA_ID`) REFERENCES `etat` (`ETA_ID`),
  CONSTRAINT `fiche_frais_ibfk_4` FOREIGN KEY (`VIS_ID`) REFERENCES `visiteur` (`VIS_ID`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;


DROP TABLE IF EXISTS `frais_forfait`;
CREATE TABLE `frais_forfait` (
  `FOR_ID` char(3) NOT NULL,
  `FOR_LIB` char(20) NOT NULL,
  `FOR_MONTANT` decimal(5,2) unsigned zerofill NOT NULL,
  PRIMARY KEY (`FOR_ID`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

INSERT INTO `frais_forfait` (`FOR_ID`, `FOR_LIB`, `FOR_MONTANT`) VALUES
('ETP',	'Forfait Etape',	110.00),
('KM',	'Frais Kilométrique',	000.62),
('NUI',	'Nuitée Hôtel',	080.00),
('REP',	'Repas Restaurant',	025.00);

DROP TABLE IF EXISTS `ligne_frais_forfait`;
CREATE TABLE `ligne_frais_forfait` (
  `FFR_ID` int(11) NOT NULL,
  `FOR_ID` char(3) NOT NULL,
  `LIG_QTE` int(2) NOT NULL,
  PRIMARY KEY (`FFR_ID`,`FOR_ID`),
  KEY `FOR_ID` (`FOR_ID`),
  KEY `FFR_ID` (`FFR_ID`),
  CONSTRAINT `ligne_frais_forfait_ibfk_1` FOREIGN KEY (`FOR_ID`) REFERENCES `frais_forfait` (`FOR_ID`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

INSERT INTO `ligne_frais_forfait` (`FFR_ID`, `FOR_ID`, `LIG_QTE`) VALUES
(1,	'ETP',	3),
(1,	'km',	500),
(1,	'NUI',	15),
(1,	'REP',	15),
(2,	'ETP',	4),
(2,	'km',	750),
(2,	'NUI',	20),
(2,	'REP',	15);

DROP TABLE IF EXISTS `LIGNE_FRAIS_HORS_FORFAIT`;
CREATE TABLE `LIGNE_FRAIS_HORS_FORFAIT` (
  `ID` int(11) NOT NULL AUTO_INCREMENT,
  `FFR_ID` int(11) NOT NULL,
  `DTE` char(3) NOT NULL,
  `LIBELLE` varchar(250) NOT NULL,
  `MONTANT` decimal(10,2) NOT NULL,
  `ETA_ID` char(2) NOT NULL,
  PRIMARY KEY (`ID`),
  CONSTRAINT `LIGNE_FRAIS_HORS_FORFAIT_ibfk_1` FOREIGN KEY (`ID`) REFERENCES `fiche_frais` (`FFR_ID`)
) ENGINE=InnoDB DEFAULT CHARSET=armscii8 COLLATE=armscii8_bin;


DROP TABLE IF EXISTS `LIGNE_FRAIS_HORS_FORFAIT_dono`;
CREATE TABLE `LIGNE_FRAIS_HORS_FORFAIT_dono` (
  `ID` int(11) NOT NULL AUTO_INCREMENT,
  `FFR_ID` int(11) NOT NULL,
  `DTE` char(11) NOT NULL,
  `LIBELLE` varchar(250) NOT NULL,
  `MONTANT` decimal(10,2) NOT NULL,
  `ETA_ID` char(2) NOT NULL,
  PRIMARY KEY (`ID`),
  KEY `ETA_ID` (`ETA_ID`),
  KEY `FFR_ID` (`FFR_ID`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

INSERT INTO `LIGNE_FRAIS_HORS_FORFAIT_dono` (`ID`, `FFR_ID`, `DTE`, `LIBELLE`, `MONTANT`, `ETA_ID`) VALUES
(18,	1,	'2024-04-18',	'Frais de déplacement',	50.00,	'VA'),
(19,	1,	'2024-04-18',	'Repas client',	30.00,	'VA'),
(20,	2,	'2024-04-18',	'Achat de matériel',	100.00,	'CR');

DROP TABLE IF EXISTS `LIGNE_FRAIS_HORS_FORFAIT_NMC`;
CREATE TABLE `LIGNE_FRAIS_HORS_FORFAIT_NMC` (
  `ID` int(11) NOT NULL AUTO_INCREMENT,
  `DTE` char(3) NOT NULL,
  `LIBELLE` varchar(250) NOT NULL,
  `MONTANT` decimal(10,2) NOT NULL,
  `ETA_ID` char(2) NOT NULL,
  PRIMARY KEY (`ID`),
  CONSTRAINT `LIGNE_FRAIS_HORS_FORFAIT_NMC_ibfk_1` FOREIGN KEY (`ID`) REFERENCES `fiche_frais` (`FFR_ID`)
) ENGINE=InnoDB DEFAULT CHARSET=armscii8 COLLATE=armscii8_bin;


DROP TABLE IF EXISTS `LIGNE_FRAIS_HORS_FORFAIT_yann`;
CREATE TABLE `LIGNE_FRAIS_HORS_FORFAIT_yann` (
  `ID` int(11) NOT NULL AUTO_INCREMENT,
  `FFR_ID` int(2) NOT NULL,
  `DTE` char(11) NOT NULL,
  `LIBELLE` varchar(250) NOT NULL,
  `MONTANT` decimal(10,2) NOT NULL,
  `ETA_ID` char(2) NOT NULL,
  PRIMARY KEY (`ID`),
  KEY `ETA_ID` (`ETA_ID`),
  KEY `FFR_ID` (`FFR_ID`),
  CONSTRAINT `LIGNE_FRAIS_HORS_FORFAIT_yann_ibfk_2` FOREIGN KEY (`ETA_ID`) REFERENCES `etat_yann` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

INSERT INTO `LIGNE_FRAIS_HORS_FORFAIT_yann` (`ID`, `FFR_ID`, `DTE`, `LIBELLE`, `MONTANT`, `ETA_ID`) VALUES
(18,	1,	'2024-04-18',	'Frais de déplacement',	50.00,	'VA'),
(19,	1,	'2024-04-18',	'Repas client',	30.00,	'VA'),
(20,	2,	'2024-04-18',	'Achat de matériel',	100.00,	'CR');

DROP TABLE IF EXISTS `USER`;
CREATE TABLE `USER` (
  `ID` tinyint(4) NOT NULL AUTO_INCREMENT,
  `U_login` varchar(255) NOT NULL,
  `U_password` varchar(255) NOT NULL,
  `dteConnexion` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' ON UPDATE current_timestamp(),
  `role` varchar(50) DEFAULT NULL,
  `VIS_ID` char(4) NOT NULL,
  PRIMARY KEY (`VIS_ID`),
  UNIQUE KEY `ID` (`ID`),
  CONSTRAINT `USER_ibfk_2` FOREIGN KEY (`VIS_ID`) REFERENCES `visiteur` (`VIS_ID`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;


DROP TABLE IF EXISTS `visiteur`;
CREATE TABLE `visiteur` (
  `VIS_ID` char(4) NOT NULL,
  `VIS_PRENOM` varchar(60) NOT NULL,
  `VIS_NOM` varchar(60) NOT NULL,
  `VIS_ADRESSE` varchar(60) NOT NULL,
  `VIS_CP` char(5) NOT NULL,
  `VIS_VILLE` varchar(60) NOT NULL,
  `VIS_DATE_EMBAUCHE` varchar(12) NOT NULL,
  PRIMARY KEY (`VIS_ID`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

INSERT INTO `visiteur` (`VIS_ID`, `VIS_PRENOM`, `VIS_NOM`, `VIS_ADRESSE`, `VIS_CP`, `VIS_VILLE`, `VIS_DATE_EMBAUCHE`) VALUES
('AD',	'Alban',	'Delorme\n',	'8 r Yves Collet\n',	'29200',	'BREST',	'08/02/2024'),
('BP',	'Baptiste\n',	'Paul\n',	'36 r Champagne \n',	'29200',	'BREST',	'08/02/2024'),
('CM',	'Constant\n',	'Martinez\n',	'18 r Duhamel \n',	'29200',	'BREST',	'08/02/2024'),
('CN',	'Constant\n',	'Navarro\n',	'2 r Louis Tiercelin\n',	'29200',	'BREST',	'08/02/2024'),
('DR',	'Dimitri\n',	'Robert\n',	'Le Grand Large 2 quai Douane \n',	'29200',	'BREST',	'08/02/2024'),
('FJ',	'Florian\n',	'Julien\n',	'83 r Suzanne Guiganton \n',	'29200',	'BREST',	'08/02/2024'),
('GL',	'Gabriel\n',	'Lejeune\n',	'27 r Kermaria \n',	'29200',	'BREST',	'08/02/2024'),
('KG',	'Kilian\n',	'Georges\n',	'11 sq Luxembourg \n',	'29200',	'BREST',	'08/02/2024'),
('RH',	'Robin\n',	'Huet\n',	'3 r Recteur Paul Henry S\n',	'29200',	'BREST',	'08/02/2024');

-- 2024-09-03 17:02:43
