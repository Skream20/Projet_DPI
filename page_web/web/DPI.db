INSERT INTO `etat` (`ETA_ID`, `ETA_LIB`) VALUES
('CL', 'Saisie clôturée'),
('CR', 'Fiche créée, saisie en cours'),
('RB', 'Remboursée'),
('VA', 'Validée et mise en paiement');

INSERT INTO `frais_forfait` (`FOR_ID`, `FOR_LIB`, `FOR_MONTANT`) VALUES
('ETP', 'Forfait Etape', 110.00),
('KM', 'Frais Kilométrique', 0.62),
('NUI', 'Nuitée Hôtel', 80.00),
('REP', 'Repas Restaurant', 25.00);

INSERT INTO `ligne_frais_forfait` (`FFR_ID`, `FOR_ID`, `LIG_QTE`) VALUES
(1, 'ETP', 3),
(1, 'KM', 500),
(1, 'NUI', 15),
(1, 'REP', 15),
(2, 'ETP', 4),
(2, 'KM', 750),
(2, 'NUI', 20),
(2, 'REP', 15);

INSERT INTO `visiteur` (`VIS_ID`, `VIS_PRENOM`, `VIS_NOM`, `VIS_ADRESSE`, `VIS_CP`, `VIS_VILLE`, `VIS_DATE_EMBAUCHE`) VALUES
('AD', 'Alban', 'Delorme', '8 r Yves Collet', '29200', 'BREST', '2024-02-08'),
('BP', 'Baptiste', 'Paul', '36 r Champagne', '29200', 'BREST', '2024-02-08'),
('CM', 'Constant', 'Martinez', '18 r Duhamel', '29200', 'BREST', '2024-02-08'),
('CN', 'Constant', 'Navarro', '2 r Louis Tiercelin', '29200', 'BREST', '2024-02-08'),
('DR', 'Dimitri', 'Robert', 'Le Grand Large 2 quai Douane', '29200', 'BREST', '2024-02-08'),
('FJ', 'Florian', 'Julien', '83 r Suzanne Guiganton', '29200', 'BREST', '2024-02-08'),
('GL', 'Gabriel', 'Lejeune', '27 r Kermaria', '29200', 'BREST', '2024-02-08'),
('KG', 'Kilian', 'Georges', '11 sq Luxembourg', '29200', 'BREST', '2024-02-08'),
('RH', 'Robin', 'Huet', '3 r Recteur Paul Henry S', '29200', 'BREST', '2024-02-08');

-- DB PROJET DPI

CREATE DATABASE IF NOT EXISTS gestion_frais;
USE gestion_frais;
 
-- Table etat
CREATE TABLE etat (
    ETA_ID CHAR(2) NOT NULL PRIMARY KEY,
    ETA_LIB VARCHAR(30) NOT NULL
);
 
-- Table visiteur
CREATE TABLE visiteur (
    VIS_ID CHAR(4) NOT NULL PRIMARY KEY,
    VIS_PRENOM VARCHAR(60) NOT NULL,
    VIS_NOM VARCHAR(60) NOT NULL,
    VIS_ADRESSE VARCHAR(60) NOT NULL,
    VIS_CP CHAR(5) NOT NULL,
    VIS_VILLE VARCHAR(60) NOT NULL,
    VIS_DATE_EMBAUCHE VARCHAR(12) NOT NULL
);
 
-- Table user
CREATE TABLE user (
    ID TINYINT NOT NULL AUTO_INCREMENT,
    U_login VARCHAR(255) NOT NULL,
    U_password VARCHAR(255) NOT NULL,
    dteConnexion TIMESTAMP NOT NULL DEFAULT '0000-00-00 00:00:00' ON UPDATE CURRENT_TIMESTAMP,
    role VARCHAR(50) NULL DEFAULT NULL,
    VIS_ID CHAR(4) NOT NULL,
    PRIMARY KEY (VIS_ID),
    UNIQUE (ID),
    FOREIGN KEY (VIS_ID) REFERENCES visiteur(VIS_ID)
);
 
-- Table fiche_frais
CREATE TABLE fiche_frais (
    FFR_ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    VIS_ID CHAR(4) NOT NULL,
    ETA_ID CHAR(2) NOT NULL,
    FFR_ANNEE CHAR(4) NOT NULL,
    FFR_MOIS ENUM('JANVIER', 'FEVRIER', 'MARS', 'AVRIL', 'MAI', 'JUIN', 'JUILLET', 'AOUT', 'SEPTEMBRE', 'OCTOBRE', 'NOVEMBRE', 'DECEMBRE') NOT NULL,
    FFR_MONTANT_VALIDE DECIMAL(10,2) NOT NULL,
    FFR_NB_JUSTIFICATIF INT NOT NULL,
    FFR_DATE_MODIF DATE NOT NULL,
    FOREIGN KEY (VIS_ID) REFERENCES visiteur(VIS_ID),
    FOREIGN KEY (ETA_ID) REFERENCES etat(ETA_ID)
);
 
-- Table frais_forfait
CREATE TABLE frais_forfait (
    FOR_ID CHAR(3) NOT NULL PRIMARY KEY,
    FOR_LIB CHAR(20) NOT NULL,
    FOR_MONTANT DECIMAL(5,2) NOT NULL
);
 
-- Table ligne_frais_forfait
CREATE TABLE ligne_frais_forfait (
    FFR_ID INT NOT NULL,
    FOR_ID CHAR(3) NOT NULL,
    LIG_QTE INT NOT NULL,
    PRIMARY KEY (FFR_ID, FOR_ID),
    FOREIGN KEY (FFR_ID) REFERENCES fiche_frais(FFR_ID),
    FOREIGN KEY (FOR_ID) REFERENCES frais_forfait(FOR_ID)
);